<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @font-face {
      font-family: 'LayijiDotted';
      src: url('Layiji_kutlaimuu.ttf') format('truetype');
    }
    body {
      font-family: 'Kanit', sans-serif;
      background-color: #f0f4f8;
    }
    canvas {
      border: 2px dashed #ccc;
      margin-top: 20px;
    }
  </style>
</head>
<body class="flex flex-col items-center px-4 py-6 min-h-screen">
  <div class="bg-white p-6 rounded-xl shadow-xl w-[900px] max-w-full flex-grow">
    <h1 class="text-3xl font-bold text-center mb-2">üìù ‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞</h1>
    <p class="text-center text-gray-600 text-sm mb-6">
      ‡∏Å‡∏£‡∏≠‡∏Å <strong>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</strong>, <strong>‡∏ä‡∏±‡πâ‡∏ô</strong>, <strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</strong> ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏î <span class="text-blue-600 font-semibold">"‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏á‡∏≤‡∏ô"</span>
    </p>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏ï‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</label>
        <select id="underline" class="w-full p-2 border rounded">
          <option value="yes">‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô</option>
          <option value="no">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏™‡πâ‡∏ô</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</label>
        <select id="numberType" class="w-full p-2 border rounded">
          <option value="arabic">‡∏≠‡∏≤‡∏£‡∏ö‡∏¥‡∏Å (1, 2, 3)</option>
          <option value="thai">‡πÑ‡∏ó‡∏¢ (‡πë, ‡πí, ‡πì)</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</label>
        <select id="lineMode" class="w-full p-2 border rounded">
          <option value="full">‡πÄ‡∏ï‡πá‡∏°‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
          <option value="half">‡∏Ñ‡∏£‡∏∂‡πà‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î</option>
        </select>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label for="fullname" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
        <input id="fullname" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" class="p-2 border rounded w-full">
      </div>
      <div>
        <label for="classroom" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏±‡πâ‡∏ô</label>
        <input id="classroom" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏õ.3" class="p-2 border rounded w-full">
      </div>
      <div>
        <label for="number" class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
        <input id="number" type="text" placeholder="‡πÄ‡∏ä‡πà‡∏ô 15" class="p-2 border rounded w-full">
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label for="fontSize" class="block text-sm font-medium text-gray-700 mb-1">‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</label>
        <select id="fontSize" class="w-full p-2 border rounded">
          <option value="36">‡πÄ‡∏•‡πá‡∏Å (36px)</option>
          <option value="48" selected>‡∏õ‡∏Å‡∏ï‡∏¥ (48px)</option>
          <option value="60">‡πÉ‡∏´‡∏ç‡πà (60px)</option>
        </select>
      </div>
    </div>

    <button onclick="generateImage()" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-2 rounded font-bold mb-4">
      ‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏ö‡∏á‡∏≤‡∏ô
    </button>

    <canvas id="myCanvas" width="900" height="1200" class="mx-auto"></canvas>

    <a id="downloadLink" class="block mt-4 text-center bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded">
      üì• ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏†‡∏≤‡∏û
    </a>
  </div>

  <footer class="text-center mt-8 text-sm text-gray-500">
    ¬© 2025 ‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏ô‡∏¥‡∏î | ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
  </footer>

  <script>
    function toThaiNumber(num) {
      const thNums = ["‡πê","‡πë","‡πí","‡πì","‡πî","‡πï","‡πñ","‡πó","‡πò","‡πô"];
      return num.toString().split("").map(d => thNums[parseInt(d)] || d).join("");
    }

    async function generateImage() {
      const canvas = document.getElementById('myCanvas');
      const ctx = canvas.getContext('2d');
      const name = document.getElementById('fullname').value.trim();
      const classroom = document.getElementById('classroom').value.trim();
      const number = document.getElementById('number').value.trim();
      const numberType = document.getElementById("numberType").value;
      const lineMode = document.getElementById("lineMode").value;
      const underline = document.getElementById("underline").value;
      const fontSize = document.getElementById("fontSize").value;

      const font = new FontFace('LayijiDotted', 'url(Layiji_kutlaimuu.ttf)');
      await font.load();
      document.fonts.add(font);
      await document.fonts.ready;

      ctx.fillStyle = "#fff";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.font = `${fontSize}px LayijiDotted`;
      ctx.fillStyle = "#000";
      ctx.fillText("‡πÅ‡∏ö‡∏ö‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡∏£‡∏≠‡∏¢‡∏õ‡∏∞", 180, 60);

      const startY = 120;
      const lineHeight = 100;

      // Check if classroom is empty or starts with ‡∏≠., ‡∏õ., or ‡∏°.
      const skipClassAndNumber = !classroom || !number || /^[‡∏≠‡∏õ‡∏°]\./.test(classroom);

      for (let i = 0; i < 10; i++) {
        const y = startY + i * lineHeight;
        const lineNumber = numberType === 'thai' ? toThaiNumber(i + 1) : (i + 1);
        const showNumber = numberType === 'thai' ? toThaiNumber(number) : number;

        if (underline === 'yes') {
          ctx.beginPath();
          ctx.moveTo(80, y - 20);  // ‡πÄ‡∏™‡πâ‡∏ô‡∏ö‡∏ô
          ctx.lineTo(canvas.width - 80, y - 20);
          ctx.strokeStyle = "#ccc";
          ctx.stroke();

          ctx.beginPath();
          ctx.moveTo(80, y + 40);  // ‡πÄ‡∏™‡πâ‡∏ô‡∏•‡πà‡∏≤‡∏á
          ctx.lineTo(canvas.width - 80, y + 40);
          ctx.stroke();

          if (lineMode === 'half') {
            ctx.beginPath();
            ctx.moveTo(80, y + 10);  // ‡πÄ‡∏™‡πâ‡∏ô‡∏Å‡∏•‡∏≤‡∏á
            ctx.lineTo(canvas.width - 80, y + 10);
            ctx.stroke();
          }
        }

        // Construct the text based on conditions
        let text = `${lineNumber}. ${name}`;
        if (!skipClassAndNumber) {
          text += ` ‡∏ä‡∏±‡πâ‡∏ô ${classroom} ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà ${showNumber}`;
        }

        if (lineMode === 'half') {
          ctx.fillText(text, 100, y);
          ctx.fillText(text, 100, y + 45);
        } else {
          ctx.fillText(text, 100, y + 20);
        }
      }

      for (let i = 0; i < 5; i++) {
        ctx.fillText("‚òÖ", 180 + i * 120, 1150);
      }

      const link = document.getElementById("downloadLink");
      link.href = canvas.toDataURL("image/png");
      link.download = `${name.replace(/\s+/g, "_") || "tracing-name"}.png`;
    }
  </script>
</body>
</html>
